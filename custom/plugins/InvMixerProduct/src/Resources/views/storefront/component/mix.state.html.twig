{# @var mixView \InvMixerProduct\DataObject\MixView #}
{# @var containerDefinitionCollection \InvMixerProduct\Struct\ContainerDefinitionCollection #}
<div>
    <div class="flashbags">
        {% for type, messages in app.flashes %}
            {% sw_include '@Storefront/storefront/utilities/alert.html.twig' with {
                type: type,
                list: messages
            } %}
        {% endfor %}
    </div>
    <hr />
    <span class="title">{{ "InvMixerProduct.sidebar.titles.size"|trans}}</span>
    <ul class="mixer-product-sizes">
        {% for availableContainerWeight in containerDefinitionCollection.availableMaxWeights %}
            <li>

                <p>{{ availableContainerWeight }}</p>
                <form method="post"
                      action="{{ path('invMixerProduct.storeFront.mix.session.container.weight.set') }}"
                      data-inv-mixer-mix-state-action="true"
                >
                    <input type="hidden" name="weight" value="{{ availableContainerWeight }}">
                    <input type="hidden" name="_csrf_token"
                           value="{{ csrf_token('invMixerProduct.storeFront.mix.session.container.weight.set') }}">
                    <button type="submit">set: {{ availableContainerWeight }}</button>
                </form>
            </li>
        {% endfor %}
    </ul>
    <hr />
    <span class="title">{{ "InvMixerProduct.sidebar.titles.design"|trans}}</span>
    <ul class="mixer-product-designs">
        {% for availableContainerDesign in containerDefinitionCollection.availableDesigns %}
            <li>
                <p>Design: {{ availableContainerDesign }}</p>
                <form method="post"
                      action="{{ path('invMixerProduct.storeFront.mix.session.container.design.set') }}"
                      data-inv-mixer-mix-state-action="true"
                >
                    <input type="hidden" name="design" value="{{ availableContainerDesign }}">
                    <input type="hidden" name="_csrf_token"
                           value="{{ csrf_token('invMixerProduct.storeFront.mix.session.container.design.set') }}">
                    <button type="submit">set: {{ availableContainerDesign }}</button>
                </form>
            </li>
        {% endfor %}
    </ul>
    <p>
        Id: {{ mixView.mixId }}
    </p>
    {% if(mixView.customer) %}
        <p>
            Customer: {{ mixView.customer.email }}
        </p>
    {% endif %}
    <form method="post" action="{{ path('invMixerProduct.storeFront.mix.session.label.set') }}"
          data-inv-mixer-mix-state-action="true"
    >
        <input type="hidden" name="_csrf_token"
               value="{{ csrf_token('invMixerProduct.storeFront.mix.session.label.set') }}">
        <label>
            Label:
            <input type="text" name="label" value="{{ mixView.mixLabel }}"/>
        </label>
        <button type="submit">set label</button>
    </form>
    <p>
        Container Design: {{ mixView.containerDefinition.design }}
    </p>
    <p>
        Container MaxWeight: {{ mixView.containerDefinition.maxContainerWeight }}
    </p>
    <p>
        Total Price: {{ mixView.mixTotalPrice.value }}
    </p>
    <ul class="mixer-product-items">
        {% for mixItem in mixView.items %}
            <li>

                <p>MixId: {{ mixItem.mix.id }}</p>
                <p>MixItemId: {{ mixItem.id }}</p>
                <p>Quantity: {{ mixItem.quantity }}</p>
                <p>Product Name: {{ mixItem.product.name }}</p>
                <p>Product Id: {{ mixItem.product.id }}</p>
                <p>Price: {{ mixItem.product.price.first.gross }}</p>
                <form method="post"
                      action="{{ path('invMixerProduct.storeFront.mix.session.item.quantity.set') }}"
                      data-inv-mixer-mix-state-action="true"
                >
                    {% set newQuantity = mixItem.quantity  + 1 %}
                    <input type="hidden" name="product_id" value="{{ mixItem.product.id }}">
                    <input type="hidden" name="_csrf_token"
                           value="{{ csrf_token('invMixerProduct.storeFront.mix.session.item.quantity.set') }}">
                    <input type="hidden" name="quantity" value="{{ newQuantity }}">
                    <button type="submit">+</button>
                </form>
                <form method="post"
                      action="{{ path('invMixerProduct.storeFront.mix.session.item.quantity.set') }}"
                      data-inv-mixer-mix-state-action="true"
                >
                    {% set newQuantity = mixItem.quantity  - 1 %}
                    <input type="hidden" name="product_id" value="{{ mixItem.product.id }}">
                    <input type="hidden" name="_csrf_token"
                           value="{{ csrf_token('invMixerProduct.storeFront.mix.session.item.quantity.set') }}">
                    <input type="hidden" name="quantity" value="{{ newQuantity }}">
                    <button type="submit">-</button>
                </form>
                <form method="post"
                      action="{{ path('invMixerProduct.storeFront.mix.session.item.quantity.set') }}"
                      data-inv-mixer-mix-state-action="true"
                >
                    <input type="hidden" name="product_id" value="{{ mixItem.product.id }}">
                    <input type="hidden" name="_csrf_token"
                           value="{{ csrf_token('invMixerProduct.storeFront.mix.session.item.quantity.set') }}">
                    <input type="hidden" name="quantity" value="0">
                    <button type="submit">X</button>
                </form>
            </li>
        {% endfor %}
    </ul>
    <p>
        <form method="get" action="{{ path('invMixerProduct.storeFront.mix.session.reset') }}" data-inv-mixer-mix-state-action="true">
        <input type="hidden" name="_csrf_token"
               value="{{ csrf_token('invMixerProduct.storeFront.mix.session.reset') }}">
            <button type="submit" class="sw-button button-reset">
                Reset
            </button>
        </form>
    </p>
    <p>
    <form method="post"
          action="{{ path('invMixerProduct.storeFront.mix.session.addToCart') }}">
        <input type="hidden" name="_csrf_token"
               value="{{ csrf_token('invMixerProduct.storeFront.mix.session.addToCart') }}">
        <button type="submit" class="sw-button">
            Add to cart
        </button>
    </form>
    </p>
</div>
